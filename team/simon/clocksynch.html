<!DOCTYPE html>
<html>
<head>
<title>
    Graded Assignment 0
</title>
 <link href="css/styles.css" rel="stylesheet">
</head>
<body>
  <img src="collegelogo.png" style="float:right;margin-left:2000px;width:18%;">
    <h1>
       <u> Clock Synchronization</u>
    </h1>
    <h2>
      A Problem in Packet Switching Delays
    </h2>

    <p style="margin-left:200px;margin-right:200px;">
      This past Summer, I worked on a project for the Physics department 
      involving audio phased arrays, a technology that requires extremely 
      precise synchronization between multiple devices. Researching solutions, 
      I discovered that there are inherent issues with packet based networking 
      that make precise synchronization impossible. These problems are explainable 
	  <img src="NTP-Algorithm.png" align="right" style="padding:20px;">
      using concepts in section 1.3 of the textbook. <br><br>

      For the sake of this exercise, Processing, queuing, transmission, and propagation
      delays will be labeled P, Q, T, and L, respectively. To make the exercise less
      infuriating, you may use D as the sum of these delays. To label delays pertaining
      to an outgoing message, type D1 and to label incoming delays, type D2. Be sure to
      label answers alphabetically. <br><br>

      
    </p>

    
  <p id="ans0"></p>
  <p id="ans1"></p>
  <p id="ans2"></p>
  <p id="ans3"></p>
  <p id="ans4"></p>
  <p id="ans5"></p>
  <p id="ans6"></p>
  <p id="ans7"></p>
  <p id="ans8"></p>
  

    <p>Answer:
    <input type="text" id="input" name="answer"></input></p>
    <button onclick='Answer(document.getElementById("input").value)'>
      Submit
    </button>
    <br>

  <p id="res"><p>
    
     <script>
       var question = 0;
       var right = 0;
      Answer("");
      function Answer(text){
      var newtext = text.replace(/ /g, "").toLowerCase();

      if (text != "") {
      question++;
      }
      switch (question) {
      case 0:
      document.getElementById("ans0").innerHTML = "Assume that upon sending or receiving a message, each router takes a timestamp. The first router's clock will be labeled A, and the second router's<br> will be labeled B. The first time measured by a router will be labeled by a 1, the second time a 2, and so on. Our challenge is to<br> synchronize the clocks at both routers, so that at any given time, A = B. A router sends a message at A1. What time, according to A, will<br> the message be received at B?";
      document.getElementById("input").value = "";
      break;
       case 1:
      document.getElementById("ans1").innerHTML = "The answer is A1 + D1.<br><br>Let's assume that we can measure this time with 100% accuracy. Note that if you know the difference, or offset, between the clocks, you can<br> synchronize with little effort. What is the difference between B and A?";
      document.getElementById("input").value = "";
       if (newtext === "a1+d1"){
       document.getElementById("res").innerHTML = "Correct!";
       right++;
      }
      else {
      document.getElementById("res").innerHTML = "Incorrect.";
      }
      break;
       case 2:
      document.getElementById("ans2").innerHTML = "The answer is B1 - (A1 + D1).<br><br>Unfortunately, we can only measure D1 on the clock at A. When B receives the message, it sees the timestamp (A1), but it doesnâ€™t know what D1 <br>is, so the difference can't be calculated. Now, assume that a message is sent from A to B, is held for some time, and then sent back. What <br>formula would you use to get the total time delay (D1 + D2)?";
      document.getElementById("input").value = "";
       if (newtext === "-a1+b1-d1"){
      document.getElementById("res").innerHTML = "Correct!";
       right++;
      }
      else {
      document.getElementById("res").innerHTML = "Incorrect.";
      }
      break;
       case 3:
      document.getElementById("ans3").innerHTML = "The answer is A2 - A1 - (B2 - B1).<br><br>Using the answers to the previous two questions, can you estimate the difference between the clocks? Use only As and Bs in your answer.";
      document.getElementById("input").value = "";
       if (newtext === "-a1+a2+b1-b2"){
      document.getElementById("res").innerHTML = "Correct!";
       right++;
      }
      else {
      document.getElementById("res").innerHTML = "Incorrect.";
      }
      break;
       case 4:
      document.getElementById("ans4").innerHTML = "The answer is (B1 + B2 - (A1 + A2))/2.<br><br>This method is actually used by GPS synch protocol and NTP (Network Time Protocol) to synchronize clocks. The fact that one way delay cannot be <br>measured makes perfect synchronization impossible. The accuracy of the previous formula depends on the assumption that the total delay <br>(D1 + D2), divided by two, is just about equal to the first delay, D1. Let's say a message takes 1 second to reach a distant router, and <br>then 3 seconds to return. What is the difference between the estimated one way delay and the true one way delay?";
      document.getElementById("input").value = "";
       if (newtext === "-a1-a2+b1+b2/2"){
      document.getElementById("res").innerHTML = "Correct!";
       right++;
      }
      else {
      document.getElementById("res").innerHTML = "Incorrect.";
      }
      break;
       case 5:
      document.getElementById("ans5").innerHTML = "The answer is 1 second.<br><br>Assume you have an extremely stable, but slow, connection. P1 and Q1 add to 9 ms, P2 and Q2 add to 11 ms, and the propagation delay is negligible. <br>T1 = 30 sec, and T2 = 31 sec. What is the difference between the estimated one way delay and the true one way delay in ms?";
      document.getElementById("input").value = "";
      if (newtext === "1"){
      document.getElementById("res").innerHTML = "Correct!";
       right++;
      }
      else {
      document.getElementById("res").innerHTML = "Incorrect.";
      }
      break;
       case 6:
      document.getElementById("ans6").innerHTML = "The answer is 501 ms.<br><br>Now your connection is blazing fast, but your router is ancient and can barely handle the strain of a single user. P1 and Q1 add to 2 sec, P2 <br>and Q2 add to 10 ms, T1 = 150 ms, and T2 = 200 ms. What is the difference between the estimated one way delay and the true one way delay in ms?";
      document.getElementById("input").value = "";
       if (newtext === "501"){
      document.getElementById("res").innerHTML = "Correct!";
       right++;
      }
      else {
      document.getElementById("res").innerHTML = "Incorrect.";
      }
      break;
       case 7:
      document.getElementById("ans7").innerHTML = "The answer is 920 ms.<br><br>This should show that the biggest differences between components of the delay are the terms that dominate, creating a bottleneck for your <br>synchronization accuracy. If your transmission delay is low, but your queueing delay is high, Q will impact synch accuracy much more than T. <br>To achieve accurate synchronization, a network must have extremely fast, stable connections between all links, and will often take a large<br> number of measurements to reduce uncertainty further. Along a fast, stable connection, P1 and Q1 add to 5 ms, P2 and Q2 add to 6 ms, <br>T1 = 2 ms and T2 = 3 ms. What is the difference between the estimated one way delay and the true one way delay in ms?";
      document.getElementById("input").value = "";
       if (newtext === "920"){
      document.getElementById("res").innerHTML = "Correct!";
       right++;
      }
      else {
      document.getElementById("res").innerHTML = "Incorrect.";
      }
      break;
      case 8:
      document.getElementById("ans8").innerHTML = "The answer is 1 ms."
      document.getElementById("input").value = "";
       if (newtext === "1"){
       right++;
      document.getElementById("res").innerHTML = "Correct! You scored " + right + "/8.";
      }
      else {
      document.getElementById("res").innerHTML = "Incorrect. You scored " + right + "/8.";
      }
      }
      }

    </script>
    
</body>
</html>
